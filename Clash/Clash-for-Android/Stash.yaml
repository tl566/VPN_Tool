#============UserScript=============#
# @Autor        chxm1023
# @TgChannel    https://t.me/chxm1023
#===================================#
# 更新日期： 2023-07-26

# 本配置地址：https://raw.githubusercontent.com/chxm1023/Script_X/main/Stash.yaml

# 建议在「设置 -> 更多设置 -> Geoip」填写使用下面链接(二选一即可)
# https://raw.githubusercontent.com/Loyalsoldier/geoip/release/Country.mmdb
# https://raw.githubusercontent.com/Hackl0us/GeoIP2-CN/release/Country.mmdb

# 解锁网易云灰色音乐，获取证书链接(下列二选一下载安装)
# https://raw.githubusercontent.com/nondanee/UnblockNeteaseMusic/master/ca.crt
# https://cdn.jsdelivr.net/gh/nondanee/UnblockNeteaseMusic@master/ca.crt

# 利用描述文件屏蔽iOS更新提醒
# https://app.initnil.com/tvOS.mobileconfig

#============UserScript=============#
# 填写订阅链接用于获取机场流量信息并在主页显示
subscribe-url: 
# 模式设置：rule（规则） / global（全局代理）/ direct（全局直连）
mode: rule
# 设置日志输出级别
log-level: info
# 允许局域网
allow-lan: true
# 监听IP白名单，可绑定单个IPv4和v6地址，"*" 为绑定所有IP地址，仅在将allow-lan设置为true时适用
# bind-address: "*"
# 混合端口，HTTP和SOCKS5用一个端口
# mixed-port: 7890                   
# 外部控制器监听地址，可以使用 RESTful API 来控制你的 clash 内核
# external-controller: 127.0.0.1:9090
# IPV6解析(开启 true|关闭 false)
ipv6: false



#===================================#
# DNS 服务器配置
dns:
  # 关闭将使用系统 DNS
  enable: true
  # IPV6解析开关；如果为false，将返回ipv6结果为空
  ipv6: false
  # 模式：redir-host或fake-ip
  enhanced-mode: fake-ip
  # DNS 监听地址
  listen: 0.0.0.0:1053
  # 解析非IP的dns用的dns服务器，只支持纯IP
  default-nameserver:
    - 114.114.114.114
    - 202.141.176.93 
    - 202.141.178.13
    - 117.50.10.10
    - 223.5.5.5
    - 119.29.29.29
    - 119.28.28.28
    - 8.8.8.8
    - system
  # 解析地址池
  fake-ip-range: 198.18.0.1/16
  # 过滤列表中的域名返回真实IP
  fake-ip-filter:
    - '+.lan' 
    - '+.stun.*.*'
    - '+.stun.*.*.*'
    - '+.stun.*.*.*.*'
    - '+.stun.*.*.*.*.*'
    - 'lens.l.google.com'
    - '*.n.n.srv.nintendo.net'
    - '+.srv.nintendo.net'
    - '+.stun.playstation.net'
    - '+.xboxlive.com'
    - 'xbox.*.*.microsoft.com'
    - '*.*.xboxlive.com'         
    - '*.msftncsi.com'
    - '*.msftconnecttest.com'
    - '*.mcdn.bilivideo.cn'
    - 'localhost.ptlogin2.qq.com'
    - '*.battlenet.com.cn'
    - '*.battlenet.com'
    - '*.blzstatic.cn'
    - '*.battle.net'
  fallback:
    - https://1.1.1.1/dns-query
    - https://dns.google/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
    - 240.0.0.0/4
  # DNS服务器
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
  # 跳过证书验证，解决部分兼容性问题
  skip-cert-verify: true



#===================================#
# 远程订阅相关
p: &p {type: http, interval: 172800, health-check: {enable: true}}
# 远程代理集
proxy-providers:
  Subscribe:
    <<: *p
    url: https://0b96e976-9ec3-44c0-aa2b-30bf8b0792ea.com/api/v1/client/subscribe?token=26f5db2b6b5e022f690b916772744640
    # URL后面填写格式1[单一订阅]: 直接填写你的机场Clash订阅[推荐此种方式，避免订阅泄露]
    # URL后面填写格式2[多个订阅]：https://api.nexconvert.com/sub?target=clash&url=请手动填入你的订阅(多机场订阅用|分割即可)&emoji=true&list=true&new_name=true&udp=false
    path: ./proxy_providers/tmp.yaml


#===================================#
# 策略组
proxy-groups:
# 全部节点
- filter: "^((?!(网易|网易云|网易云音乐|音乐|云音乐|官网|流量|加群|订阅|获取|刷新|鸡场|机场|订购|购买|套餐|重置|分享|网址|邀请|公众号|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/chxm1023/Script_X/main/icon/stash1.png
  include-all: true
  name: 全部节点
  proxies: []
  type: select
# 策略选择
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Back.png
  name: 策略选择
  proxies:
    - 延迟最低
    - 全部节点
    - 负载均衡
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
  type: select
# Emby
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Emby.png
  name: Emby
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
    - 直连模式
  type: select
# TikTok
- icon: https://raw.githubusercontent.com/chxm1023/Script_X/main/icon/TikTok_1.png
  name: TikTok
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Github
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/GitHub.png
  name: Github
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Google
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Google_Search.png
  name: Google
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Spotify
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Spotify.png
  name: Spotify
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Twitter
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Twitter.png
  name: Twitter
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Netflix
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netflix_Letter.png
  name: Netflix
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Disney
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Disney+.png
  name: Disney+
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# YouTube
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/YouTube.png
  name: YouTube
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# ChatGPT
- icon: https://raw.githubusercontent.com/chxm1023/Script_X/main/icon/ChatGPT/ChatGPT4.png
  name: ChatGPT
  proxies:
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Telegram
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Telegram.png
  name: Telegram
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Instagram
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Instagram.png
  name: Instagram
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# Facebook
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Facebook.png
  name: Facebook
  proxies:
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
    - 策略选择
  type: select
# 网易云音乐
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netease_Music_Unlock.png
  name: 网易云音乐
  proxies:
    - 直连模式
    - 网易云节点
  type: select
# 网易云节点
- filter: "(?i)(网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Netease_Music.png
  include-all: true
  name: 网易云节点
  proxies: []
  type: select
# 微软服务
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Microsoft.png
  name: 微软服务
  proxies:
    - 直连模式
    - 策略选择
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
  type: select
# 苹果服务
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple.png
  name: 苹果服务
  proxies:
    - 直连模式
    - 策略选择
  type: select
# 系统更新
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Apple_Update.png
  name: 系统更新
  proxies:
    - 拦截模式
    - 直连模式
  type: select
# 全球加速
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Global.png
  name: 全球加速
  proxies:
    - 策略选择
    - 直连模式
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 全部节点
  type: select
# 国际代理
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Airport.png
  name: 国际代理
  proxies:
    - 策略选择
    - 香港节点
    - 台湾节点
    - 日本节点
    - 韩国节点
    - 狮城节点
    - 美国节点
    - 直连模式
  type: select
# 延迟最低
- filter: "^((?!(网易|网易云|网易云音乐|音乐|云音乐|官网|流量|加群|订阅|获取|刷新|鸡场|机场|订购|购买|套餐|重置|分享|网址|邀请|公众号|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Download.png
  include-all: true
  interval: 600
  lazy: true
  name: 延迟最低
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 负载均衡
- filter: "(?=.*((?i)\U0001F1ED\U0001F1F0|香|港|香港|香江|香岛|湾仔|港仔|九龙|铜锣湾|旺角|HK|Hong|HongKong))^((?!(台|日|韩|新|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/SSID.png
  include-all: true
  interval: 600
  lazy: true
  name: 负载均衡
  proxies: []
  tolerance: 50
  type: load-balance
  url: http://cp.cloudflare.com/generate_204
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Proxy.png
  name: 直连模式
  proxies:
    - DIRECT
    - 策略选择
  type: select
# 拦截模式
- icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Reject.png
  name: 拦截模式
  proxies:
    - REJECT
  type: select
# 香港节点
- filter: "(?=.*((?i)\U0001F1ED\U0001F1F0|香|港|香港|香江|香岛|湾仔|港仔|九龙|铜锣湾|旺角|HK|Hong|HongKong))^((?!(台|日|韩|新|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Hong_Kong.png
  include-all: true
  interval: 600
  lazy: true
  name: 香港节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 台湾节点
- filter: "(?=.*((?i)\U0001F1E8\U0001F1F3|台|台湾|台北|新北|桃园|台中|台南|高雄|基隆|新竹|嘉义|苗栗|彰化|南投|云林|屏东|台东|花莲|宜兰|澎湖|金门|连江|TW|Taiwan))^((?!(港|日|韩|新|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png
  include-all: true
  interval: 600
  lazy: true
  name: 台湾节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 日本节点
- filter: "(?=.*((?i)\U0001F1EF\U0001F1F5|日|日本|川日|东京|大阪|泉日|埼玉|沪日|深日|JP|Japan|名古屋|福冈|仙台|京都|Japan))^((?!(港|台|韩|新|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Japan.png
  include-all: true
  interval: 600
  lazy: true
  name: 日本节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 韩国节点
- filter: "(?=.*((?i)\U0001F1F0\U0001F1F7|韩|韩国|南韩|南朝鲜|高丽|大韩民国|首尔|世宗|济州市|水原|釜山|大邱|仁川|光州|大田|蔚山|KR|Korea|Korean|South
    Korea))^((?!(港|台|日|新|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Korea.png
  include-all: true
  interval: 600
  lazy: true
  name: 韩国节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 新加坡节点
- filter: "(?=.*((?i)\U0001F1F8\U0001F1EC|新|狮|獅|坡|新加坡|星|星加坡|星洲|狮城|SG|Singapore))^((?!(港|台|日|韩|美|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Singapore.png
  include-all: true
  interval: 600
  lazy: true
  name: 狮城节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204
# 美国节点
- filter: "(?=.*((?i)\U0001F1FA\U0001F1F8|美|美国|美利坚合众国|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|华盛顿|内华达|蒙大纳|怀俄明州|菲尼克斯|阿尔伯克基|丹佛|US|United
    States|States|American))^((?!(港|台|日|韩|新|英|平|邀|群|刷新|网|网易|网易云|网易云音乐|音乐|云音乐|Netease|Music|\U0001D40C\U0001D42E\U0001D42C\U0001D422\U0001D41C|Unbolck|Update|music|\U0001F3B5|\U0001F3B6|\U0001F3A7)).)*$"
  icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/United_States.png
  include-all: true
  interval: 600
  lazy: true
  name: 美国节点
  proxies: []
  tolerance: 50
  type: url-test
  url: http://cp.cloudflare.com/generate_204



#===================================#
# 远程规则集
rule-providers:
  

#===================================#
# 规则集
rules:
    - MATCH,全球加速
